
# Logi.Builder函数使用说明

## 目录

- [行计算型函数](#行计算型函数)
  - [!=](#a0)
  - [&](#a1)
  - [<>](#a2)
  - [ABS](#a3)
  - [AND](#a4)
  - [AVERAGE](#a5)
  - [AVERAGEIFV](#a6)
  - [COS](#a7)
  - [COUNT](#a8)
  - [DATE](#a9)
  - [EMPTY](#a10)
  - [IF](#a11)
  - [IFERROR](#a12)
  - [IRR](#a13)
  - [ISERROR](#a14)
  - [LOG](#a15)
  - [MAX](#a16)
  - [MIN](#a17)
  - [NOT](#a18)
  - [NPV](#a19)
  - [OR](#a20)
  - [POWER](#a21)
  - [ROUND](#a22)
  - [SIN](#a23)
  - [SUM](#a24)
  - [SWITCH](#a25)
  - [XIRR](#a26)
  - [XNPV](#a27)
  - [YEARFRAC](#a28)
- [列计算型函数](#列计算型函数)
  - [average](#b0)
  - [averageifv](#b1)
  - [averageprevious](#b2)
  - [count](#b3)
  - [day](#b4)
  - [diff](#b5)
  - [growth](#b6)
  - [halfyears](#b7)
  - [lag](#b8)
  - [latter](#b9)
  - [lead](#b10)
  - [linear](#b11)
  - [max](#b12)
  - [min](#b13)
  - [months](#b14)
  - [previous](#b15)
  - [quarters](#b16)
  - [sum](#b17)
  - [year](#b18)
  - [years](#b19)

## 行计算型函数

> != <span id='a0'>

- 函数描述

    !=

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |element1|数值 | 数组|❌|❌|暂无|
  |element2|数值 | 数组|❌|❌|暂无|

- 返回值类型

    **布尔值**

- 示例

    !=(element1, element2)

> & <span id='a1'>

- 函数描述

    连接两个元素

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|❌|❌|暂无|
  |值|数值 | 数组|❌|❌|暂无|

- 返回值类型

    **数组**

- 示例

    &(argument, argument)

> <> <span id='a2'>

- 函数描述

    <>

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |element1|数值 | 数组|❌|❌|暂无|
  |element2|数值 | 数组|❌|❌|暂无|

- 返回值类型

    **布尔值**

- 示例

    <>(element1, element2)

> ABS <span id='a3'>

- 函数描述

    计算绝对值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 布尔值|❌|❌|需要计算绝对值的值|

- 返回值类型

    **数值**

- 示例

    ABS(值)

> AND <span id='a4'>

- 函数描述

    返回所有表达式的与值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |逻辑值|数值 | 布尔值|✔️|❌|逻辑表达式|

- 返回值类型

    **布尔值**

- 示例

    AND(逻辑值1, 逻辑值2, ...)

> AVERAGE <span id='a5'>

- 函数描述

    返回算术平均值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|✔️|❌|计算平均值时用到的数值或范围|

- 返回值类型

    **数组**

- 示例

    AVERAGE(值1, 值2, ...)

> AVERAGEIFV <span id='a6'>

- 函数描述

    返回算术平均值,忽略空值与错误

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值1|数值 | 数组|❌|❌|计算平均值时用到的数值或范围|
  |值2|数值 | 数组|❌|❌|计算平均值时用到的数值或范围|

- 返回值类型

    **数组**

- 示例

    AVERAGEIFV(值1, 值2)

> COS <span id='a7'>

- 函数描述

    返回给定角度的余弦值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |角度|数值 | 数组|❌|❌|要取其余弦值的角度，以弧度表示|

- 返回值类型

    **数值**

- 示例

    COS(角度)

> COUNT <span id='a8'>

- 函数描述

    计算区域中包含数字的单元格的个数

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|✔️|❌|计数时要检查的第一个值或范围|

- 返回值类型

    **数组**

- 示例

    COUNT(值1, 值2, ...)

> DATE <span id='a9'>

- 函数描述

    返回在Excel日期时间中代表日期的数字

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |年|数值 | 数组|❌|❌|日期中的年份|
  |月|数值 | 数组|❌|❌|日期中的月份|
  |日|数值 | 数组|❌|❌|日期中的“日”部分|

- 返回值类型

    **数组**

- 示例

    DATE(年, 月, 日)

> EMPTY <span id='a10'>

- 函数描述

    暂无

- 参数信息

    无参数

- 返回值类型

    **空值**

- 示例

    EMPTY()

> IF <span id='a11'>

- 函数描述

    判断是否满足某个条件,如果满足,则返回第一个值,否则返回另一个值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |条件|布尔值|❌|❌|一个表达式或对包含表达式的单元格的引用，该表达式代表某种逻辑值，即 TRUE 或 FALSE|
  |为 TRUE 时的返回值|数值 | 数组|❌|❌|当逻辑表达式为 TRUE 时函数返回的值|
  |为 FALSE 时的返回值|数值 | 数组|❌|❌|当逻辑表达式为 FALSE 时函数返回的值|

- 返回值类型

    **数组**

- 示例

    IF(条件, 为 TRUE 时的返回值, 为 FALSE 时的返回值)

> IFERROR <span id='a12'>

- 函数描述

    如果表达式是错误的,则返回默认值,否则返回表达式自身的值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|❌|❌|value 本身不为错误值的情况下要返回的值|
  |默认值|数值 | 数组|❌|❌|value 是错误值的情况下函数返回的值|

- 返回值类型

    **数组**

- 示例

    IFERROR(值, 默认值)

> IRR <span id='a13'>

- 函数描述

    返回一系列现金流的内部收益率

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |现金流数额|数组|❌|❌|其中含有投资相关收益或支出的数组或范围（现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率）|

- 返回值类型

    **数值**

- 示例

    IRR(现金流数额)

> ISERROR <span id='a14'>

- 函数描述

    检查值是否错误

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |任意值|数组 | 布尔值 | 数值 | 日期|❌|❌|任意一个表达式|

- 返回值类型

    **布尔值**

- 示例

    ISERROR(任意值)

> LOG <span id='a15'>

- 函数描述

    根据底数返回数值的对数

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|❌|❌|要计算其以给定底数为底的对数的值（值必须为正数）|
  |底数|数值 | 数组|❌|❌|用于计算此对数的底数|

- 返回值类型

    **数值**

- 示例

    LOG(值, 底数)

> MAX <span id='a16'>

- 函数描述

    返回一组数值中的最大值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|✔️|❌|计算最大值时所用的值或范围|

- 返回值类型

    **数组**

- 示例

    MAX(值1, 值2, ...)

> MIN <span id='a17'>

- 函数描述

    返回一组数值中的最小值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|✔️|❌|计算最小值时所用的值或范围|

- 返回值类型

    **数组**

- 示例

    MIN(值1, 值2, ...)

> NOT <span id='a18'>

- 函数描述

    对逻辑表达式的值求反

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |逻辑值|数值 | 布尔值|❌|❌|逻辑表达式|

- 返回值类型

    **布尔值**

- 示例

    NOT(逻辑值)

> NPV <span id='a19'>

- 函数描述

    根据收支现金流和贴现率,返回净限值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |贴现率|数值|❌|❌|一个期间内的投资贴现率|
  |现金流|数组|❌|❌|未来现金流|

- 返回值类型

    **数值**

- 示例

    NPV(贴现率, 现金流)

> OR <span id='a20'>

- 函数描述

    返回所有表达式的或值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |逻辑值|数值 | 布尔值|✔️|❌|逻辑表达式|

- 返回值类型

    **布尔值**

- 示例

    OR(逻辑值1, 逻辑值2, ...)

> POWER <span id='a21'>

- 函数描述

    返回某一数值的某次幂

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |基数|数值 | 数组|❌|❌|要计算其指数次幂的数值（如果基数为负，则指数必须为整数）|
  |指数|数值 | 数组|❌|❌|指定底数的自乘幂次值|

- 返回值类型

    **数组**

- 示例

    POWER(基数, 指数)

> ROUND <span id='a22'>

- 函数描述

    按指定位数对数值进行四舍五入

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|❌|❌|要四舍五入为位数位小数的数值|
  |位数|数值 | 数组|❌|❌|要舍入到的小数位数（位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数）|

- 返回值类型

    **数值**

- 示例

    ROUND(值, 位数)

> SIN <span id='a23'>

- 函数描述

    返回给定角度的正弦值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |角度|数值 | 数组|❌|❌|要返回其正弦值的角度，以弧度表示|

- 返回值类型

    **数值**

- 示例

    SIN(角度)

> SUM <span id='a24'>

- 函数描述

    计算对应区域的所有数值的和

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |值|数值 | 数组|✔️|❌|要相加的数值或范围|

- 返回值类型

    **数组**

- 示例

    SUM(值1, 值2, ...)

> SWITCH <span id='a25'>

- 函数描述

    根据计算表达式的值返回与第一个匹配值对应的结果,如果没有匹配项,则返回默认值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |表达式|数值 | 数组|❌|❌|任何有效的值|
  |案例|数值 | 数组|✔️|❌|检查是否与表达式匹配的第一种情况|
  |值|数值 | 数组|✔️|❌|案例与表达式匹配后返回的对应值|
  |默认值|数值 | 数组|❌|❌|没有与表达式匹配的情况后返回的可选值（指定为最后一个参数）|

- 返回值类型

    **数组**

- 示例

    SWITCH(表达式, 案例1, 值1, 案例2, 值2, ..., 默认值)

> XIRR <span id='a26'>

- 函数描述

    计算一连续期间现金流的内部收益率

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |现金流数额|数组|❌|❌|其中含有投资相关收益或支出的数组或范围(现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率)|
  |现金流日期|数组|❌|❌|与现金流数额参数中的现金流对应的日期数组或范围|
  |收益率估值|数值|❌|✔️|对内部回报率的估算值（默认值为0.1）|

- 返回值类型

    **数值**

- 示例

    XIRR(现金流数额, 现金流日期, [收益率估值])

> XNPV <span id='a27'>

- 函数描述

    计算净现值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |贴现率|数值|❌|❌|一个期间内的投资贴现率|
  |现金流数额|数组|❌|❌|其中含有投资相关收益或支出的单元格范围|
  |现金流日期|数组|❌|❌|与现金流数额参数中的现金流对应的日期值单元格范围|

- 返回值类型

    **数值**

- 示例

    XNPV(贴现率, 现金流数额, 现金流日期)

> YEARFRAC <span id='a28'>

- 函数描述

    计算两个日期之间的天数(取整天数)占一年的比例

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |开始日期|数值|❌|❌|暂无|
  |结束日期|数值|❌|❌|暂无|
  |计算方式|数值|❌|✔️|要使用的日计数基准类型:	或省略:US(NASD) 30/360	1:实际/实际	2:实际/360	3:实际/365	4:欧洲 30/360|

- 返回值类型

    **数值**

- 示例

    YEARFRAC(开始日期, 结束日期, [计算方式])

## 列计算型函数

> average <span id='b0'>

- 函数描述

    计算区域中数值的算术平均数

- 参数信息

    无参数

- 返回值类型

    **数值 | 数组**

- 示例

    {ref}.average()

> averageifv <span id='b1'>

- 函数描述

    返回算术平均值,忽略空值与错误

- 参数信息

    无参数

- 返回值类型

    **数值**

- 示例

    {ref}.averageifv()

> averageprevious <span id='b2'>

- 函数描述

    计算在此之前一段时间范围内的值的平均值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时间|日期|❌|❌|暂无|

- 返回值类型

    **数组**

- 示例

    {ref}.averageprevious(时间)

> count <span id='b3'>

- 函数描述

    计算区域中包含数值的个数

- 参数信息

    无参数

- 返回值类型

    **数值 | 数组**

- 示例

    {ref}.count()

> day <span id='b4'>

- 函数描述

    返回日期的日期值

- 参数信息

    无参数

- 返回值类型

    **数组**

- 示例

    {ref}.day()

> diff <span id='b5'>

- 函数描述

    计算两个日期之间的天数、月数或年数

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时期|日期|❌|❌|计算中要使用的开始日期-结束日期|

- 返回值类型

    **数组**

- 示例

    {ref}.diff(时期)

> growth <span id='b6'>

- 函数描述

    暂无

- 参数信息

    无参数

- 返回值类型

    **数组**

- 示例

    {ref}.growth()

> halfyears <span id='b7'>

- 函数描述

    取当前时间范围内的所有半年度

- 参数信息

    无参数

- 返回值类型

    **矩阵**

- 示例

    {ref}.halfyears()

> lag <span id='b8'>

- 函数描述

    将一组数列右移若干个单位

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时期|日期|❌|❌|暂无|

- 返回值类型

    **数组**

- 示例

    {ref}.lag(时期)

> latter <span id='b9'>

- 函数描述

    取在此之后一段时间范围内的值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时间|日期|❌|❌|暂无|

- 返回值类型

    **矩阵**

- 示例

    {ref}.latter(时间)

> lead <span id='b10'>

- 函数描述

    将一组数列左移若干个单位

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时期|日期|❌|❌|暂无|

- 返回值类型

    **数组**

- 示例

    {ref}.lead(时期)

> linear <span id='b11'>

- 函数描述

    根据起始值和终止值返回一组等差数列

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |起始值|数值|❌|❌|暂无|
  |终止值|数值|❌|❌|暂无|

- 返回值类型

    **数组**

- 示例

    {ref}.linear(起始值, 终止值)

> max <span id='b12'>

- 函数描述

    计算区域中所有数值的最大值

- 参数信息

    无参数

- 返回值类型

    **数值 | 数组**

- 示例

    {ref}.max()

> min <span id='b13'>

- 函数描述

    计算区域中所有数值的最小值

- 参数信息

    无参数

- 返回值类型

    **数值 | 数组**

- 示例

    {ref}.min()

> months <span id='b14'>

- 函数描述

    取当前时间范围内的所有月度

- 参数信息

    无参数

- 返回值类型

    **矩阵**

- 示例

    {ref}.months()

> previous <span id='b15'>

- 函数描述

    取在此之前一段时间范围内的值

- 参数信息

  |参数名|参数类型|可重复|可选|参数描述|
  |---|---|---|---|---|
  |时间|日期|❌|❌|暂无|

- 返回值类型

    **矩阵**

- 示例

    {ref}.previous(时间)

> quarters <span id='b16'>

- 函数描述

    取当前时间范围内的所有季度

- 参数信息

    无参数

- 返回值类型

    **矩阵**

- 示例

    {ref}.quarters()

> sum <span id='b17'>

- 函数描述

    计算区域中所有数值的和

- 参数信息

    无参数

- 返回值类型

    **数值 | 数组**

- 示例

    {ref}.sum()

> year <span id='b18'>

- 函数描述

    返回日期的年份值

- 参数信息

    无参数

- 返回值类型

    **数组**

- 示例

    {ref}.year()

> years <span id='b19'>

- 函数描述

    取当前时间范围内的所有年度

- 参数信息

    无参数

- 返回值类型

    **矩阵**

- 示例

    {ref}.years()
